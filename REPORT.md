# Дипломная работа по профессии «Специалист по информационной безопасности». Track Forensics

### Корецкий Владимир Павлович  

## Описание инцидента
Службой безопасности компании «Х» была зафиксирована подозрительная сетевая активность. Вам нужно проанализировать ситуацию, расследовать инцидент и найти следы активности атакующих.
[Исходные данные](https://disk.yandex.ru/d/cYI1nU_Uy4mfAg):  
* дамп оперативной памяти;  
* побитовая копия диска.  

## Общая информация о представленных данных (evidencies)  
#### Dump оперативной памяти 
* Файл - incident.mem (дамп оперативной памяти)  
* Type файла: MEM
* Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86
* Image date and time : 2019-03-10 13:06:28 UTC+0000  
* Image local date and time : 2019-03-10 06:06:28 -0700    
  
#### Dump жесткого диска - побитовая копия диска  
* Файл - Wood.E01 (побитовая копия диска)  
* Type файла: E01  
* Verification MD5: 84648ad119e390f8cf2201a145c5d8ba  
* Verification SHA1: 0e52068110899a5279eeb7617fb7ace089fde135 
* Unique Description: Wilfred Wood's PC  
  
## Задача
Составить подробный отчёт о проведённом расследовании. Он должен включать себя информацию, подкреплённую доказательствами в виде скриншотов:
* обнаруженные следы атакующих;
* восстановление картины произошедшего инцидента в виде описания характеристики инцидента;
* маппинг действий атакующих по матрице MITRE ATT&CK;
* предложения по ликвидации последствий и восстановлению.

## 1. Характеристика инцидента
  
Инцидент имел место 9-10 марта 2019 года, то есть в **субботу-воскресение**.
Исследование представленным материалов позволило восстановить следующую картинку инцидента:
* Злоумышленники с помощью фишинговой рассылки получили доступ к сетевой инфраструктуре, отправив архив Refund_form.zip. Пользователь разархивировал файл и запустил. После этого был выполнен powershell скрипт закодированный по стандарту base64.  
* С помощью вредоносной программы злоумышленники могли осуществлять сбор информации о системе. Кроме установки дополнительных программ и обновлений было запущено скачивание по-видимому вредоносных программ с ресурса www<span></span>.sendspase.com.  
* Дальнейшее закрепление в системе осуществлялось путем манипуляций с планировщиков и в реестре операционной системы.  
* Атакующие совершают успешное удаленное подключение от имени локального пользователя Wilfred. Поскольку пользователь Wilfred является локальным администратором у атакующих появился соответствующий контроль над системой. 
* В ходе атаки был создан новый пользователь - Support с повышенными привилегиями, под которым выполнялись многие следующие действия.   
* Для дальнейшего закрепления пользователь  Support манипулирует с планировщиком задач - Task Scheduler, в результате чего запускается вредоносный скрипт Update.bat, ограничиваются возможности сканера Windows Defender. В ходе этого позволяет исследуются архитектура сети, порты TCP/UDP, сервисы на них, собирается информация через сетевые протокола.
* **Для сокрытия следов присутсвия в ходе атаки было удалено множество файлов, кроме того, была осуществленая подмена временных меток.**
* В целях организации утечки информации использовался ресурс www<span></span>.sendspase.com.  
 
## 2. Описание инцидента по матрице MITRE ATT&CK.  

### 2.1. Первоначальное проникновение (Initial Access)  

|MitreAtt&ck technique|Название|Подтехника|ID|
|------|-----|-----|----|
|Основная|Fishing|Spearphishing Attachment|T1566.001|
  

Первоначально проникновение было осуществлено с помощью фишинговой рассылки – отправив архив Refund_form.zip. Архив загрузил пользователь Wilford с почтового сервера Яндекс (рис. 1).  

![Рис. 1. История браузера Internet Explorer](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig1.png "Рис.1. История браузера Internet Explorer") 
*Рис.1. История браузера Internet Explorer*  

**На рис. 1а представлены дополнительные подтверждающие данные - история загрузок. По данным истории работы Internet Explore загрузка файла состоялась 09.03.2019 в 17:25:50 MSC**.

![Рис. 1a. История загрузок ресурсов через браузер Internet Explorer](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig1a.png "Рис.1a. История загрузок ресурсов через браузер Internet Explorer") 
*Рис.1. История загрузок ресурсов через браузер Internet Explorer*  

Загруженный файл обнаружен в папке downloads пользователя Wilford (Рис. 2). Там же находится папка Refund_form, в которой присутствует ярлык Refund_form.lnk.  

![Рис. 2. Папка download пользователя Wilford](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig2.png "Рис. 2. Папка download пользователя Wilford") 
*Рис. 2. Папка download пользователя Wilford*

При попытке работы с ним Defender хостовой рабочей станции с OS Windows 11 сообщает об угрозе (Рис. 3).  

![Рис. 3. Сообщения об угрозе при работе с файлом Refund_form.lnk](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig3.png "Рис. 3. Сообщения об угрозе при работе с файлом Refund_form.lnk")  
*Рис. 3. Сообщения об угрозе при работе с файлом Refund_form.lnk*

Для дальнейшего анализа Refund_form.lnk был экспортирован его хэш (SHA1 f7f2272dcd11984dae9da9f64b18a7f0f49f76c9) и проверен сервисом Virustotal с результатами представленными на рис. 4.  

![Рис. 4. Результаты проверки Refund_form.lnk сервисом Virustotal](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig4.png "Рис. 4. Результаты проверки Refund_form.lnk сервисом Virustotal")  
*Рис. 4. Результаты проверки Refund_form.lnk сервисом Virustotal* 

Некоторые вендоры описывают его как trojan. На рис. 5 представлены тактики MitreAtt&ck, в которых он применялся.  

![Рис. 5. Тактики и техники, в которых применяется Refund_form.lnk](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig5.png "Рис. 5. Тактики и техники, в которых применяется Refund_form.lnk")  
*Рис. 5. Тактики и техники, в которых применяется Refund_form.lnk*
  
Таким образом, выявлена что загруженный файл является вредоносом. Крому того, можно выдвинуть гипотезу о том, что на рабочей станции пользователя Wilford был или отключен Windows Defender или настроено разрешение на запуск вредоносных программ.  
  
### 2.2. Исполнение (Execution)
|MitreAtt&ck technique|Название|Подтехника|ID|
|------|-----|-----|----|
|Основная|User Execution|Malicious File|T1204.002|
|Вспомогательная технология|Indicator Removal|||
|Вспомогательная технология|Discovery (Исследование) |Password Policy Discovery|T1201|
|Вспомогательная технология|Discovery (Исследование) |Network Service Discovery|T1046|

Исследование Timeliner файла, извлеченного из RAM dump, позволило выявить, что загруженный malware был запущен 2019-03-09 в 14:31:04 UTC+0000 (Рис. 6) или в 17:31:04 MSC. 

![Рис. 6. Timeliner с информацией о запуске malware](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig6.png "Рис. 6. Timeliner с информацией о запуске malware")  
*Рис. 6. Timeliner с информацией о запуске malware* 

Информация по ключу user_assist:
|[USER ASSIST]| C:\Users\Wilfred\Downloads\Refund_form\Refund_form.lnk| Registry: \??\C:\Users\Wilfred\ntuser.dat /ID: N/A/Count: 1/FocusCount: 0/TimeFocused: 0:00:00.501000

При анализе файла $MFT на предмет дальнейшей злонамеренной активности, выясняется, что именно он был запущен от имени пользователя Wilford первым в чреде дальнейшей подозрительной деятельности (рис. 7) по тайм-лайну.  

![Рис. 7. Анализ time-line $MFT файла](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig7.png "Рис. 7. Анализ time-line $MFT файла")  
*Рис. 7. Анализ time-line $MFT файла*  

Таким образом, выяснилось, что пользователь разархивировал файл и запустил его 03.09.2019 года в 14:15:25 UTC (17:15:25 MSC) (по MFT файлу) или в 14:31:04 UTC+0000 (Рис. 6) или в 17:31:04 MSC (по таймлайнеру, извлеченному из dump RAM. В результате чего был выполнен powershell скрипт, закодированный по стандарту base64 (Рис. 8).  

![Рис. 8. Powershell script запускаемые при работе Refund_form](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig8.png "Рис. 8. Powershell script запускаемые при работе Refund_form")  
*Рис. 8. Powershell script запускаемые при работе Refund_form*  

В соответствии с отчетом CAPE, при выполнении скрипта запускаются следующие сервисы:
* Started Services
* WSearch
* SecurityHealthService
  
С помощью вредоносной программы злоумышленники могли осуществлять сбор информации о системе, признаки чего будут представлены позже. Кроме того, выявлено скачивание вредоносных программ, обновлений, а также вполне легитимных программ. Локализованы они главным образом в общей папке Temp, а также Temp – папках отдельных юзеров.
В частности, из анализа NTUSER.DAT выяснилось, что в папку C:\Users\Wilfred\AppData\Local\Temp\ были загружены исполняемые файлы и запущены: iepv.exe, netscan.exe и др. (Рис. 9).

![Рис. 9. Ntuser.dat пользователя Wilford](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig9.png "Рис. 9. Ntuser.dat пользователя Wilford")  
*Рис. 9. Ntuser.dat пользователя Wilford* 
  
Из открытых источников удалось собрать следующую информацию об этих приложениях:  
1.	iepv.exe – это исполняемый файл утилиты IE PassView, которая предназначена для поиска и отображения паролей, сохранённых в браузерах Internet Explorer или Microsoft Edge  
2.	netscan.exe – инструмент для сканирования и анализа сети на подключённые устройства и сервисы. Некоторые функции программы:  
* сканирование портов TCP, UDP и SNMP;  
* обнаружение общих папок в сети (включая скрытые и writable);  
* получение информации о сетевых устройствах через WMI, SNMP, HTTP, SSH и PowerShell;  
* гибкие варианты фильтрации и отображения результатов сканирования;  
* экспорт результатов в различные форматы (от XML до JSON).  
Анализ netscan.exe по хэшу на virustotal подтверждает эту информацию (рис. 10).

![Рис. 10. Анализ исполняемого файла netscan.exe](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig10.png "Рис. 10. Анализ исполняемого файла netscan.exe")  
*Рис. 10. Анализ исполняемого файла netscan.exe*  
  
То есть, можно предположить, что в качестве дополнительных технологий Mitre Att&ck использовались технологии Discovery (Исследование) Network Service Discovery (T1046) и Password Policy Discovery, T1201. 
Кроме того, подозрительно выглядят запуски, которые хотя и легитимных сервисов, но в контексте происходящего, могут свидетельствующих о возможности редактирования реестра и утановки каких-то дополнительных приложений:  

* *2019-03-09 16:57:13Z {F38BF404-1D43-42F2-9305-67DE0B28FC23}\regedit.exe (2)*
* *2019-03-09 16:36:29Z {D65231B0-B2F1-4857-A4CE-A8E7C6EA7D27}\msiexec.exe (1)*.
  
Это может означать дальнейшее закрепление в системе путем манипуляций с планировщиков и в реестре операционной системы.
Как упоминалось выше в папке C:\Windows\Temp тоже следы деятельности злоумышленников (Рис. 11). Это приложения SDelete, инструмент командной строки, который позволяет безопасно удалять файлы и папки. SDelete перезаписывает удалённые файлы на диске, чтобы сделать их неустранимыми даже с помощью технологий восстановления. Тем самым можно предположить, что в данном случае применялась технология T1070	Indicator Removal. Единственное, подозрительно выглядит время модификации приложения.  
  
Кроме того, в папке C:\Windows\Temp можно обнаружить файлы 1, 111.bat, 2.bat, 3.bat, утилиты iepv.ziP, предназначенная для выгрузки паролей из браузера Internet Explorer, netscan_portable.zip – предназначенная для TCP-сканирования сети, RDPWInst-v1.6.2.msi программа для организации удаленного подключения (Рис. 11).

![Рис. 11. Содержимое папки C:\Windows\Temp](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig11.png "Рис. 11. Содержимой папки C:\Windows\Temp")
*Рис. 11. Содержимое папки C:\Windows\Temp* 

Все они были обнаружены в базе знаний Virustotal (Рис. 12 – 15).  

![Рис. 12. Содержимое папки C:\Windows\Temp](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig12.png "Рис. 12. Содержимой папки C:\Windows\Temp")
*Рис. 12. Информация о файле 111.bat*  
  
![Рис. 13. Информация о файле 2.bat](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig13.png "Рис. 13. Информация о файле 2.bat")
*Рис. 13. Информация о файле 2.bat*   

![Рис. 14. Информация о файле 2.bat](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig14.png "Рис. 14. Информация о файле 2.bat")
*Рис. 14. Информация о файле 3.bat*

![Рис. 15. Информация о файле 2.bat](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig15.png "Рис. 15 Информация о файле Iepv.zip")
*Рис. 15. Информация о файле 3.bat*
  
Еще одно подозрительное событие это удаление истории WindowsDefender (событие 1013 от 09.03.2019) активности вредоносного приложения – журнал Microsoft-Windows-Windows Defender%4Operational.evtx (Рис. 16)  

![Рис. 16. Очистка журнала вредоносной или потенциально нежелательной программы](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig16.png "Рис. 16. Очистка журнала вредоносной или потенциально нежелательной программы")
*Рис. 16. Очистка журнала вредоносной или потенциально нежелательной программы*

Общий итог: запуск загруженное приложения запустил ряд событий: скачивание вредоносного и легитимного программного обеспечения, удаление файлов, очистку журнала Windows Defender.

## 2.3.	Повышение привилегий (Privilege Escalation)

|MitreAtt&ck technique|Название|Подтехника|ID|
|------|-----|-----|----|
|Основная|Valid Accounts||T1078|
|Дополнительная технология|Command and Control Remote Access Software||T1219|
|Дополнительная технология|Process Injection||T1055|
|Дополнительная технология|Credentials from Password Stores||T1555|
 
Злоумышленники получили доступ к конфиденциальной информации пользователя Wilferd и осуществили ряд действий, которые подтверждают данную гипотезу. 
Из анализа подключений через Dump оперативной памяти выяснилось, что в период выявленной подозрительной активности к рабочей станции Wilfred осуществлялось два подключения через сетевые TCP/IP порты 80 и 3389 (рис. 17).

![Рис. 17. Информация извлеченная из оперативной памяти](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig17.png "Рис. 17. Информация извлеченная из оперативной памяти")
*Рис. 17. Информация извлеченная из оперативной памяти*

Известно, что порт 80 соответствует протоколу HTTP (HyperText Transfer Protocol) и используется для незащищённой веб-коммуникации, а Порт 3389 – это стандартный сетевой порт для протокола удалённого рабочего стола (RDP) и соответственно можно сделать вывод, что была осуществлена попытка удаленно управлять рабочими столами. 

Из анализа журнала Remote Connection Manager, было осуществлено успешное удаленное подключение от имени локального пользователя Wilfred c IP-адреса 192.168.1.71 (Рис. 18).  

![Рис. 18. Удаленное подключение от имени пользователя Wilfred](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig18.png "Рис. 18. Удаленное подключение от имени пользователя Wilfred")
*Рис. 18. Удаленное подключение от имени пользователя Wilfred*

По информации из SOFTWARE.dat на рабочей станции была установленные программа RDP Wrapper Library:

*User SID: S-1-5-21-3583694148-1414552638-2922671848-1003* 
*LastWrite: 2019-03-09 16:36:29Z*
*20190309 - RDP Wrapper Library 1.6.2 (Stas'M Corp. and contributors)*  

a также записи: 

*Launching tracing v.20200511*  
*Microsoft\Tracing*  
*2019-03-09 14:20:28Z       Explorer_RASAPI32*  
*2019-03-09 14:18:16Z       ie4uinit_RASAPI32*  
*2019-03-10 06:57:35Z       iexplore_RASAPI32*                               
  
Ключи Tracing Explorer_RASAPI32 в реестре Windows указывает на то, что какое-то приложение (законное или нет) впервые попыталось установить сетевое соединение для загрузки файлов. Ключи «RASAPI32» и «RASMANCS» создаются, когда приложение взаимодействует с API удалённого доступа (rasapi32.dll) и менеджером соединений удалённого доступа (rasman.dll). Таким образом, наличие ключей «RASAPI32» и «RASMANCS» может указывать на попытки приложений установить сетевые соединения.  

На рис. 18а представлены установленные программы в период времени атаки, среди которых присутствует и RDP Wrapper Library.

<img width="974" height="574" alt="image" src="https://github.com/user-attachments/assets/f246a589-bad6-4dd0-9330-dbcb9a4f09fd" />
*Рис. 18а. Установленные программы на атакованной рабочей станции*

09-02-2019 пользователь wifred удаленно залогинился. Но при попытке войти в учётную запись, используя учётные данные (имя пользователя и пароль), отличные от тех, которые использует текущий пользователь, сеанс был завершен.

<img width="1440" height="987" alt="image" src="https://github.com/user-attachments/assets/f4dab088-7d50-4a1e-bdf9-6d10b25adccd" />
*Рис. 18b. Сообщения о неудачной попытки логина*

Таким образом, можно сделать вывод, что атакующие получили контроль на над системой, завладев данным пользователя Wilfred, который является администратором:
Данные из файла SAM:
*Username        : Wilfred [1003]*
*Full Name       : Wilfred*
*User Comment    :* 
*Account Type    : Default Admin User*
*Account Created : 2019-03-09 14:17:41Z*
*--> Password does not expire*
*--> Normal user account.*  
Стоит отметить, что запуск ipve.exe появляеся появлением файлы password.txt на рабочем столе пользователя (Рис. 19).  

![Рис. 19. Рабочий стол пользователя Wilferd c файлом, содержащим строки пароля](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig19.png "Рис. 19. Рабочий стол пользователя Wilferd c файлом, содержащим строки пароляd")
*Рис. 19. Рабочий стол пользователя Wilferd c файлом, содержащим строки пароля* 

![Рис. 19a. Последовательность запуска сканеров](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig19a.png "Рис. 19a. Рис. 19a. Последовательность запуска сканеров")
*Рис. 19a. Последовательность запуска сканеров* 

Запуск утилит программ, связанных со сканирование и выявлением пароле пользовтеля (iepv), сканированием сети визуально состоялись с 6:31:24 до 6:41:06 (2019-03-10).

Соответствующая запись в NTUSER.dat:  
  
*OpenSavePidlMRU*  
*LastWrite time: 2019-03-10 06:35:43Z*
*OpenSavePidlMRU\**  
*LastWrite Time: Sun Mar 10 06:40:02 2019*
*Note: All value names are listed in MRUListEx order.*
  *My Computer\C:\Windows\Temp\iepv.zip*  
  *My Computer\C:\Windows\Temp\netscan_portable.zip*  
  *My Computer\C:\Windows\Temp\1*  
  *passwords.txt*  
*OpenSavePidlMRU\txt*  
*LastWrite Time: Sat Mar  9 15:35:28 2019*  
*Note: All value names are listed in MRUListEx order.*  
  *passwords.txt**

Таким образом, можно сделать вывод, что в ходе атаки злоумышленники получили административные права и осуществляли запуски валидных приложений с повышенными правами.

## 2.4.	Обход защиты (Defence Evasion)

|MitreAtt&ck technique|Название|Подтехника|ID|
|------|-----|-----|----|
|Основная|Valid Accounts||T1078|
|Дополнительная технология|Process Injection||T1055|
|Дополнительная технология|Indicator Removal|File Deletion||
|Дополнительная технология|Indicator Removal|Timestomp, изменение временных меток|T1070.006|

Чтобы снизить вероятность своего обнаружения, злоумышленники создали нового пользователя Support с административными правами. Это подтверждается информацией из файла реестра SAM (Рис. 20).  

![Рис. 20. Информация о пользователе Support из файла SAM](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig20.png "Рис. 20. Информация о пользователе Support из файла SAM")
*Рис. 20. Информация о пользователе Support из файла SAM*
 
Пользователя создали его, находясь под учетной записью Wilfred (Рис. 21), что следует из журнала событий Security.  

![Рис. 21. Событие 4720 журнала Security – создание пользователя Support](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig21.png "Рис. 21. Событие 4720 журнала Security – создание пользователя Support")
*Рис. 21. Событие 4720 журнала Security – создание пользователя Support* 

Далее Support осуществляет логин со своим паролем, что следует из hashdump dum RAM (Рис. 22).  

![Рис. 22. Hash Dump извлеченный из Dump оперативной памяти](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig22.png "Рис. 22. Hash Dump извлеченный из Dump оперативной памяти")
*Рис. 22. Hash Dump извлеченный из Dump оперативной памяти*  

Анализируя приведенные хэши, модно сделать несколько выводов относительно паролей и настроек безопасности в системе. Обе учетные записи ("Wilfred" и "Support") имеют одинаковые LM-хэши: aad3b435b51404eeaad3b435b51404ee. Это стандартный LM-хэш пустой строки или пароля длиной менее 14 символов. Причина проста: LM-хэш обрабатывает пароль таким образом, что, если пароль короче 14 символов, он дополняется нулями до длины 14 символов, а затем разделяется на две части по 7 символов. Эти части преобразуются в верхний регистр и шифруются отдельно. Поскольку оба пользователя имеют короткие пароли, первые 7 символов обеих частей будут одинаковыми (или нулевыми). Таким образом, пароль у Wilfrod очень простой и может быть легко подобран по хэшу.    
Пользователь Support «совершает» ряд действий. Запускает ряд утилит. В ntuser.dat пользователя Support содержатся, например, следующие записи: 
  
  * {D65231B0-B2F1-4857-A4CE-A8E7C6EA7D27}\SnippingTool.exe (10)  
  * {D65231B0-B2F1-4857-A4CE-A8E7C6EA7D27}\calc.exe (9)  
  * {D65231B0-B2F1-4857-A4CE-A8E7C6EA7D27}\mspaint.exe (8)  
  * {D65231B0-B2F1-4857-A4CE-A8E7C6EA7D27}\xpsrchvw.exe (7)  
  * {D65231B0-B2F1-4857-A4CE-A8E7C6EA7D27}\WFS.exe (6)  
  * {D65231B0-B2F1-4857-A4CE-A8E7C6EA7D27}\magnify.exe (5).
  
Под пользователем Support, также осуществляются манипуляции с планировщиком задач.  
Кроме того, выявлено, что нижеследующие процессы запускаются с избыточными правами (информация получена из dump RAM утилитой volatility malfind) (наличие флага PAGE_EXECUTE_READWRITE):  
* 1 раз присутствует в отчете volatility malfind:  
Process: svchost.exe Pid: 876 Address: 0x220000  
Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE  
Flags: CommitCharge: 2, MemCommit: 1, PrivateMemory: 1, Protection: 6  
* 2 раза присутствует в отчете volatility malfinad:  
Process: svchost.exe Pid: 2604 Address: 0x4d40000  
Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE  
Flags: CommitCharge: 128, MemCommit: 1, PrivateMemory: 1, Protection: 6  
* 2 раза присутствует в отчете volatility malfinad:  
Process: explorer.exe Pid: 3484 Address: 0x3840000  
Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE  
Flags: CommitCharge: 2, MemCommit: 1, PrivateMemory: 1, Protection: 6  
* 5 раз присутствует в отчете volatility malfinad:  
Process: powershell.exe Pid: 3672 Address: 0x13e0000  
Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE  
Flags: CommitCharge: 1, PrivateMemory: 1, Protection: 6  
* 3 раза присутствует в отчете volatility malfinad:  
Process: iexplore.exe Pid: 992 Address: 0x2bc0000  
Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE  
Flags: CommitCharge: 2, MemCommit: 1, PrivateMemory: 1, Protection: 6  
* 1 раз присутствует в отчете volatility malfinad:  
Process: WmiPrvSE.exe Pid: 2480 Address: 0x1a50000  
Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE  
Flags: CommitCharge: 1, PrivateMemory: 1, Protection: 6

Кроме того, в целях сокрытия следов на атакованном компьютере было удалено множество файлов. В период атаки, с 09.03.2019 по 10.03.2019, было удалено более 500 файлов и папок (Рис. 22a, 22b). 

![Рис. 22a. Свидетельство об удалении файлов (удаленные префетч-файлы)](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig22a.png "Рис. 22a. Свидетельство об удалении файлов (удаленные префетч-файлы)")
*Рис. 22a. Свидетельство об удалении файлов (удаленные префетч-файлы)*  

![Рис. 22b. Свидетельство об удалении файлов (удаленные префетч-файлы)](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig22a.png "Рис. 22a. Свидетельство об удалении файлов (удаленные префетч-файлы)")
*Рис. 22b. Свидетельство об удалении файлов (удаленные файлы по результатам анализа Autopsy)* 

### 2.4.1 Изменение временных меток
Исследование различных источников о запусках исполняемых файлов и скриптов, изменений файлов реестра, загрузок показывают несоответствие временных меток событий, проихсодящих в ходе атаки. Это позволяет сделать вывод, о том, что атакующими были изменений временные метки для сокрытия своих следов. Рассмотрим некоторые факты, свидетельствующие в пользу этой гипотезы.  
**Обращает на себя внимание тот факт, что все события имели место в субботу-воскресение, 9-10 марта 2019 года. До момента 17:17:41 2019-03-09 в журнале Security отсутствует информация о логине пользователя Wilfred, однако действия от него исполняются. В 17:17:41 2019-03-09 появляется запись о том, что меняется аккаунт пользователя.**

<img width="2400" height="1420" alt="image" src="https://github.com/user-attachments/assets/2a8c538f-1c0d-47b0-bfe7-20073e752ab2" />
*Рис. 22d. Первый отмеченный в логах логин пользователя Wilford* 

Кроме того, в журнале Security вообще отсутствуют записи о событиях начиная с 2018-03-2018 по 17:17:07 2019-03-09, что выглядит очень подозрительно и наводит на мысль об удалении этой информации (Рис. 22e).

<img width="1723" height="524" alt="image" src="https://github.com/user-attachments/assets/7f740f0d-a635-457d-b109-eb87060681d7" />
*Рис. 22e. Отсутствие записей в журнале Security* 

Из NTUSER.dat следует, что 2019-03-09 в 16:57:35Z в реестр была внесена запись о запуске Updater.bat. Этот скрипт выполняется при входе пользователя в систему:  
  
*Environment*  
*LastWrite Time 2019-03-09 16:57:35Z*  
*TEMP -> %USERPROFILE%\AppData\Local\Temp*  
*TMP -> %USERPROFILE%\AppData\Local\Temp*  
*UserInitMprLogonScript -> C:\Users\Wilfred\AppData\Roaming\Identities\Updater.bat* 
  
Соответственно, с помощью утилиты *сmdline volatility* удалось выяснить, что запуск Updater.bat состоялся из терминала:  
  
*cmd.exe pid:   3008*  
*Command line : C:\Windows\system32\cmd.exe /c C:\Users\Wilfred\AppData\Roaming\Identities\Updater.bat* 
  
Утилита *pstree volatility* позволила выяснить, что процесс быд запущен с PID 3008 в 12:30:35 2019-03-10: 
  
*0x851fea60:cmd.exe                                  3008   3692      1     25 2019-03-10 12:30:35 UTC+0000*  
  
Это соответствует времени последнему входа в систему пользователя Wilfred.  
  
На себя обращает внимание разброс времени: запись в NTUSER.dat имеет временную метку **2019-03-09 в 16:57:35Z** при том, что запуск Refund_form состоялся почти за 2 часа 28 минут до этого, в **14:31:04 2019-03-09**. Это уже подозрительно. 
  
Запуск Updater.bat осуществился в **12:30:35 2019-03-10**, a загруженны malware-файлы (1, 2.bat, 111.bat, iepv.zip, netscan_portable.zip) и RDPWInst-v1.6.2.msi были в период с **15:52:03 09.03.2019** до **7:07:52 10.03.2019**, то есть до запуска скрипта Updater.bat, в ходе выполнения которого должна была осуществить их загрузка. Например, запись в UserClass о работе iepv.zip была внесена в 6:40, в нерабочее время:  
  
MRU Time             |Modified             | Accessed             | Created              | Zip_Subfolder        | MFT File Ref |Resource
------------         |------------         | ------------         | ------------         | ------------         | ------------ |------------
2019-03-10 06:41:33  |2019-03-10 06:40:04  | 2019-03-10 06:40:04  | 2019-03-10 06:40:04  |                      |              |My Computer\C:\Windows\Temp\iepv.zip [70610] [Desktop\2\0\1\0\1\]|

Аналогично выглядят записи о других процессах. То есть, наблюдается противоречивая непоследовательность событий. 

Кроме того, в журнале Security обнаружена запись об изменении системного времени (Рис. 22f).
<img width="1471" height="766" alt="image" src="https://github.com/user-attachments/assets/e274fc28-06bb-4639-a1b6-06a033c1d21b" />
*Рис. 22f. Запись об изменении системного времени
  
Обращает на себя внимание и время очистки журнала Windows Defender, которая состоялась в **17:29:25 09.03.2019** (Рис. 16), что может означать, что события загрузки malware состоялись до этого момента времени, а не после **12:30:35 2019-03-10**.

И еще одно замечание. В файле 

## 2.5.	Закрепление (Persistence)

|MitreAtt&ck technique|Название|Подтехника|ID|
|------|-----|-----|----|
|Основная|Valid Accounts||T1078|
|Дополнительная технология|Exploitation for Defense Evasion||T1211|

Для дальнейшего закрепления пользователь Support манипулирует с планировщиком задач - Task Scheduler, в результате чего запускается вредоносный скрипт Updater.bat, ограничиваются возможности сканера Windows Defender (Рис. 23).  

![Рис. 23. Настройка планировщика задач для запуска утилиты Updater.bat](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig23.png "Рис. 23. Настройка планировщика задач для запуска утилиты Updater.bat")
*Рис. 23. Настройка планировщика задач для запуска утилиты Updater.bat*  

В качестве вспомогательной техники используется технология Exploitation for Defense Evasion (T1211) - за счет нее был обновлен Defender.  
Основные показатели:  

* Дата и время: 2019-03-10, 05:56:46  
* Автор изменений: Support  
* Триггер привязан к календарю: 2019-03-10, 09:00:00  
* Сканирование запланировано в ежедневном режиме
* Процесс запускается консольной команой:    
*<Command>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Command> <Arguments>-NonI -W hidden -c "IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp HKCU:\Software\Microsoft\Windows\CurrentVersion debug).debug)))"</Arguments>*
    
Подозрительным выглядит запуск в скрытом режиме.  
В настройках задач обнаруживается запланированная работа -RestrictPriviligesScan  
  
![Рис. 24. Ограничение возможностей сканирования Defender](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig24.png "Рис. 24. Ограничение возможностей сканирования Defender")
*Рис. 24. Ограничение возможностей сканирования Defender*  
  
В соответствии с планировщиком, запуск был совершен под аккаунтом Wilfred, что показывает анализ dump оперативной памяти (Рис. 25).

![Рис. 25. Запуск утилиты Updater](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig25.png "Рис. 25. Запуск утилиты Updater")
*Рис. 25. Запуск утилиты Updater*  
  
Сам запускаемый планировщиком файл локализован в одной из папок пользователя Wilfred (Рис. 26).  

![Рис. 26. Локализация файла Updater](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig26.png "Рис. 26. Локализация файла Updater")
*Рис. 26. Локализация файла Updater*  
 
Анализ Updater.bat по его hash сервисом virustotal показал, что это malware (Рис. 27).

![Рис. 27. Информация о Updater.bat по данным Virustotal](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig27.png "Рис. 27. Информация о Updater.bat по данным Virustotal")
*Рис. 27. Информация о Updater.bat по данным Virustotal*  

Представленный сервисом паттерн поведения утилиты Updater.bat коррелирует с ранее выявленным IP адресам, с которого осуществлялось TCP/IP сканирование (Рис. 28). Кроме того, его запуск осуществляется как powershell script (Рис. 29).

![Рис. 28. Паттерн поведения Updater.bat](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig28.png "Рис. 28. Паттерн поведения Updater.bat")
*Рис. 28. Паттерн поведения Updater.bat*  

![Рис. 29. Powershell-script запуска Updater.bat и запускаемые утилитой процесс](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig29.png "Рис. 29. Powershell-script запуска Updater.bat и запускаемые утилитой процесс")
*Рис. 29. Powershell-script запуска Updater.bat и запускаемые утилитой процесс*  

Процессы, которые представлены на рис. 26 подтверждают сделанные выводы из анализа dump оперативной памяти по поводу инъекций процессов. 
Кроме того, выявлен процесс taskhost.exe, в котором реализуется взаимодействие с ресурсом sendspace. 

### 2.6. Утечка данных (Exfiltration)
|MitreAtt&ck technique|Название|Подтехника|ID|
|------|-----|-----|----|
|Основная|Exfiltration (Эксфильтрация данных)|Exfiltration Over Web Service: Exfiltration to Cloud Storage|T1567.002|
Как выяснилось, для организации утечки информации использовался ресурс www.sendspase.com – ресурс для обмена файлами, в том числе и большими (рис. 30).

![Рис. 30. Из истории браузера Internet Explorer ](https://github.com/VladKoretski/sib-Diplom-Track-Forensics/blob/main/FWSfiles/fig30.png "Рис. 30. Из истории браузера Internet Explorer ")
*Рис. 30. Из истории браузера Internet Explorer*   

Утилита volatility yarascan.txt c правилом yara позволяла извлечь информацию о многочисленных обращениях к ресурсу процесса taskhost.exe (несколько десятков раз за 09.03.2019), который, хотя и является легитимным для операционной системы windows, но может быть использован как маскировка для многих malware-процессов.

Rule: r1
Owner: Process taskhost.exe Pid 324
0x0181e207  68 74 74 70 73 3a 2f 2f 61 70 69 2e 62 69 6e 67   https://api.bing  
0x0181e217  2e 63 6f 6d 2f 71 73 6d 6c 2e 61 73 70 78 3f 71   .com/qsml.aspx?q  
0x0181e227  75 65 72 79 3d 73 65 6e 64 73 70 61 63 65 2e 63   uery=sendspace.c  
0x0181e237  6f 6d 25 32 46 26 6d 61 78 77 69 64 74 68 3d 33   om%2F&maxwidth=3  
0x0181e247  39 38 26 72 6f 77 68 65 69 67 68 74 3d 32 30 26   98&rowheight=20&  
0x0181e257  73 65 63 74 69 6f 6e 48 65 69 67 68 74 3d 31 36   sectionHeight=16  
0x0181e267  30 26 46 4f 52 4d 3d 49 45 53 53 34 4e 26 6d 61   0&FORM=IESS4N&ma  
0x0181e277  72 6b 65 74 3d 65 6e 2d 55 53 0d 0a 0d 0a 12 20   rket=en-US......  
0x0181e287  7f e4 5b 40 75 52 36 bc 88 7f 80 00 00 00 00 00   ..[@uR6.........  
0x0181e297  06 46 11 7f 77 00 46 06 00 00 00 00 00 00 01 00   .F..w.F.........  
0x0181e2a7  00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 bc   ................  
0x0181e2b7  36 52 75 40 5b 64 03 00 00 00 00 00 00 00 00 00   6Ru@[d..........  
0x0181e2c7  00 00 41 08 00 00 00 00 00 00 01 00 00 00 86 c8   ..A.............  
0x0181e2d7  64 23 98 d6 d4 01 56 a1 64 23 98 d6 d4 01 ff ff   d#....V.d#......  
0x0181e2e7  ff ff ff ff ff 7f 00 00 00 00 00 00 00 00 86 c8   ................  
0x0181e2f7  64 23 98 d6 d4 01 00 00 00 00 00 00 00 00 00 00   d#..............  
   
### 2.7. Маппинг действий атакующих по матрице MITRE ATT&CK
  
Для наглядности инцидент далее представлен *маппинг действий атакующих по матрице MITRE ATT&CK* — в виде таблицы, отражающей соответствие тактики и техник, которые использовали атакующие в рамках исследуемого инцидента.  

|Этап|Техника | Реализация техники | Описание |Дата и время инцидента (MSC)| Пользователь|
|---|---|---|----|----|----|
|Initial Access|Phishing: Spearphishing Attachment, T1566.001|Злоумышленники могут отправлять электронные письма с вредоносным вложением в попытке получить доступ к системам жертвы. При открытии вложения (и, возможно, при снятии защиты) вредоносная программа использует уязвимость или запускается непосредственно в системепользователя|Легитимный  пользователь загрузил с почтового сервера Яндекс архив Refund_form.zip|09.03.2019, 17:25:50|Wilfred|
|User Execution|Malicious File, T1204.002|Злоумышленник может рассчитывать на то, что пользователь откроет вредоносный файл, чтобы получить доступ к его выполнению. Пользователи могут быть подвергнуты социальной инженерии, чтобы заставить их открыть файл, который приведет к выполнению кода|Легитимный  пользователь разархивировал загруженный архив и запустил исполняемый файл. В результате чего был выполнен powershell скрипт, закодированный по стандарту base64 и на целевую машину были загружены ряд исполняемых файлов и bat-файлов |2019-03-09, 17:31:04|Wilfred|
|Defence Ivasion|Clear Windows Event Logs, T1070.001|Злоумышленники могут отключить ведение журнала событий Windows, чтобы ограничить использование данных для обнаружения и аудита|Удаление истории WindowsDefender из журнала Microsoft-Windows-Windows Defender%4Operational.evtx|09.03.2019, 17:25:50|Wilfred|
|Defence Ivasion|File Deletion, T1070.004|Злоумышленники могут удалять файлы, оставленные в результате их действий по вторжению|С рабочей станции удалено более 500 ресурсов|09.03.2019, 17:18 - 2019-03-10, 14:04||
|Discovery|Network Service Discovery, T1046|Злоумышленники могут попытаться получить список служб, запущенных на удаленных хостах и устройствах инфраструктуры локальной сети, в том числе тех, которые могут быть уязвимы для удаленного использования программного обеспечения. Распространенные методы получения этой информации включают сканирование портов, уязвимостей и/или списка слов с использованием инструментов, встроенных в систему|Запущена программа netscan_portable, инструмент для сканирования и анализа сети на подключённые устройства и сервисы |10.03.2019, 06:35:43-51|Wilfred|
|Discovery|Password Policy Discovery, T1201|Злоумышленники могут попытаться получить список служб, запущенных на удаленных хостах и устройствах инфраструктуры локальной сети, в том числе тех, которые могут быть уязвимы для удаленного использования программного обеспечения. Распространенные методы получения этой информации включают сканирование портов, уязвимостей и/или списка слов с использованием инструментов, встроенных в систему|Запущена программа iepv, которая позволяет выявить пароли и иные данных легальных пользователей. На рабочем стале пользователя Wilfred появляется файл Password.txt. Но в соответствии с атрибутами файл был создан 09.03.2019 в 15:35:28 |10.03.2019, 06:41:06|Wilfred|
|Defence Ivasion|File Deletion, T1070.004|Злоумышленники могут удалять файлы, оставленные в результате их действий по вторжению|С рабочей станции удалено более 500 ресурсов|09.03.2019, 17:18 - 2019-03-10, 14:04|-|
|Persistence|Create Account: Local Account, T1136.001|Злоумышленники могут создать локальную учетную запись для обеспечения доступа к системам-жертвам|Из под легального пользователя создаетcя пользователь Support|10.03.2019, 06:45:48|Wilfred|
|Lateral Movement|Windows Remote Management, T1021.006|Злоумышленники могут использовать действительные учетные записи для взаимодействия с удаленными системами с помощью Windows Remote Management и выполнять действия, которые используются для входа в систему|Из под легального пользователя осуществляется удаленный вход через IP-адрес 192.168.1.71|09.03.2019, 19:35:27 и 19:55:12|Wilfred|
|Defence Evasion|Exploitation for Defense Evasion, T1211|Злоумышленники могут использовать уязвимость системы или приложения для обхода средств защиты|Настойка планировщика задач - Task Scheduler в целях запуска вредоносного скрипта Updater.bat, за счет ограничения возможности сканера Windows Defender осуществлена пользователем, созданном атакующими|2019-03-10, 05:56:46 |Support|
|Defence Evasion|Exploitation for Defense Evasion, T1211|Злоумышленники могут использовать уязвимость системы или приложения для обхода средств защиты|Запск Updater.bat, ограничивающего Windows Defender, осуществлена после логина легального пользователя|2019-03-10, 05:56:46 |Wilfred|
|Exfiltration|Exfiltration Over Web Service: Exfiltration to Cloud Storage, T1567.002|---|Как выяснилось, для организации утечки информации использовался ресурс <span></span>www.sendspace.com – ресурс для обмена файлами, в том числе и большими|2019-03-10, 6:58:46, 7:06:55, 7:07:44, 12:29:54|Wilfred|

## 3. Рекомендации по ликвидации последствий инцидента и восстановлению  
По результатам анализа инцидента предлагается осуществить ряд мероприятий по лицквидации последствий и восстановлению системы, а также меропроиятий профилактического действия для недопоущения или снижения вероятности возникновения подобных инцидентов в будущем.

### Рекомендации по ликвидации последствий инцидента
1. Отключить зараженные сетевые устройства, в частность рабочую станцию Wilford необходимо изолировать от корпоративной сети;
2. Провести очистку систему, включая полное удаление найденных вредоносных компонентов и восстановить целостность операционной системы:
* удалить пользователя “Support”, созданного атакующими;
* изменить аутентификационные данные скомпрометированного пользователя Wilfred;
* очистить от вредоносных файлов папки Temp, задач планировщика, особенно обращая на ярлыки файлов, архиво и .bat-файлам;
* провести редакцию реестров операционной системы;
2. Провести проверку всей сетевой инфраструктуры на наличие признаков заражения и аномальной активности на те же артефакты и исследовать на предмет закрепления, кодовых инъекций, настроек пользователя другие элементы сетевой инфраструктуру
### Рекомендации по восстанавлению безопасности и функциональности системы
1. вернуть систему в нормальное функционирование, предварительно убедившись в отсутствии остатков угроз;
2. провести повторную проверку на работоспособность защитных механизмов и стабильность работы систем
### Рекомендации по мерам профилактики
1. пересмотреть политику безопасности и внедрить дополнительные защитные механизмы:
* изменить политику по управлению паролями пользователей: отключить хранение LM-хэшей, использовать длинные и сложные пароли, регулярно менять пароли;
* запретить хранение конфиденциальной информации в открытых файлах, папках, в текстовом виде и прочее;
* повысить требования к управлению прав пользования с учетом принципа минимальных прав, когда пользователи получают ровно столько полномочий, сколько необходимо для выполнения обязанностей;
* пересмотреть политику назначения прав операционным процесам;
2. установить надежное антивирусного ПО и настроить регулярное автоматического обновления сигнатур malkware
3. применять инструменты мониторинга процессов и активных проверок целостности системы;
4. ввести систему мониторинга активности служб и приложений, работающих в системе;
5. повысить контроль над активностью сети: ввести систему мониторинга исходящих соединений и трафика, отслеживая возможные попытки передачи данных сторонним сервисам;
6. ввести практику регулярного обновление операционных систем и установленного ПО до последних версий, содержащих исправленные уязвимости;
7. ввести практику регулярного резервного копирования и восстановления данных и хранения резервных копий вне зоны основного риска;
8. для удаленных подключений использовать VPN и двухфакторную аутентификация для подтверждения подлинности пользователя перед доступом к сетевой инфраструктуре  
9. Повысить осведомленность сотрудников на предмет кибербезопасности
* на тему фишинговых атак и безопасной работы с почтовыми ресурсами;
* на тему по изменению политики безопасности, включая хранения и обращения конфиденциальной информации (логинов, паролей);
* на тему реагирования при возникновении подозрительной активности  
10. Пересмотреть локальные правовые акты, регулирующие на предприятии вопросы информационной безопасности и защиты информации
* закрепить в рамках политики информационной безопасности и иных локально-правовых актов вышеуказанные защитные механизмы;
* сформулировать ответственность должностных лиц за нарушения требований в области кибербезопасность;
* организовать регулярный аудит информационной безопасности и оценке рисков.

### Приложение
Первый вариант таблицы Митр-Аттак



| Этап атаки  | ID техники |  Техника  | Комментарии |
|-----------|---------|----------|-----------|
| Initial Access (Первоначальный доступ) |	T1566.001 | Phishing:Spearphishing Attachment | Фишинговое письмо с архивом Refund_form.zip, содержащим вредоносный файл |
|Execution (Выполнение)|T1204.002| User Execution: Malicious File	| Обнаружен файл Refund_form.lnk, архив замаскированный под файл типа WordPad, содержащий вредоносный скрипт |
|Persistence (Закрепление)|T1053.005|	Scheduled Task/Job: Scheduled Task|Создание задач с регулярным выполнением|
|Persistence (Закрепление)|T1136|Create Account|Создание пользователя Support|
|Privilege Escalation (Повышение привилегий)|T1078.003|Valid Accounts: Local Accounts| Получение доступа к аккаунту легитимного пользователя Wilfred|
|Privilege Escalation (Повышение привилегий)|T1055|Process Injection|Инъекции в различные процессы|
|Defense Evasion (Предотвращение обнаружения)|T1078.003|Valid Accounts: Local Accounts|Создание пользователя Support|
|Defense Evasion (Предотвращение обнаружения)|T1211|Exploitation for Defense Evasion|Обновление версии Windows Defender|
|Defense Evasion (Предотвращение обнаружения)|T1070|Indicator Removal|Удаление файлов и манипуляции с временными метками|
|Credential Access (Получение учетных данных)|T1555.003|Credentials from Password Stores: Credentials from Web Browsers|Атакующие испольщовали файл с паролями пользователя passwords.txt, использование утилиты Iepv|
|Discovery (Исследование)|T1046|Network Service Discovery|Использование Netscan|
|Discovery (Исследование)|T1201|Password Policy Discovery|Использование Iepv|
|Command and Control (Управление и Контроль)|T1219|Remote Access Software|Удаленное подключение под пользоватлем Wilford|
|Exfiltration (Эксфильтрация данных)|T1567.002|Exfiltration Over Web Service: Exfiltration to Cloud Storage|Использование ресурса <span></span>Sendspace.com|


