# Дипломная работа по профессии «Специалист по информационной безопасности». Track Forensics

### Корецкий Владимир Павлович  

## Описание инцидента
Службой безопасности компании «Х» была зафиксирована подозрительная сетевая активность. Вам нужно проанализировать ситуацию, расследовать инцидент и найти следы активности атакующих.
[Исходные данные](https://disk.yandex.ru/d/cYI1nU_Uy4mfAg):  
* дамп оперативной памяти;  
* побитовая копия диска.  

## Общая информация о представленных данных (evidencies)  
#### Dump оперативной памяти 
* Файл - incident.mem (дамп оперативной памяти)  
* Type файла: MEM
* 
* Image date and time : 2019-03-10 13:06:28 UTC+0000  
* Image local date and time : 2019-03-10 06:06:28 -0700    
  
#### Dump жесткого диска - побитовая копия диска  
* Файл - Wood.E01 (побитовая копия диска)  
* Type файла: E01  
* Verification MD5: 84648ad119e390f8cf2201a145c5d8ba  
* Verification SHA1: 0e52068110899a5279eeb7617fb7ace089fde135 
* Unique Description: Wilfred Wood's PC  
  
## Задача
Составить подробный отчёт о проведённом расследовании. Он должен включать себя информацию, подкреплённую доказательствами в виде скриншотов:
* обнаруженные следы атакующих;
* восстановление картины произошедшего инцидента в виде описания характеристики инцидента;
* маппинг действий атакующих по матрице MITRE ATT&CK;
* предложения по ликвидации последствий и восстановлению.

## 1. Характеристика инцидента
  
Исследование представленным материалов позволило восстановить следующую картинку инцидента:
* Злоумышленники с помощью фишинговой рассылки получили доступ к сетевой инфраструктуре, отправив архив Refund_form.zip. Пользователь разархивировал файл и запустил. После этого был выполнен powershell скрипт закодированный по стандарту base64.  
* С помощью вредоносной программы злоумышленники могли осуществлять сбор информации о системе. Кроме установки дополнительных программ и обновлений было запущено скачивание по-видимому вредоносных программ с ресурса www<span></span>.sendspase.com.  
* Дальнейшее закрепление в системе осуществлялось путем манипуляций с планировщиков и в реестре операционной системы.  
* Атакующие совершают успешное удаленное подключение от имени локального пользователя Wilfred. Поскольку пользователь Wilfred является локальным администратором у атакующих появился соответствующий контроль над системой. 
* В ходе атаки был создан новый пользователь - Support с повышенными привилегиями, под которым выполнялись многие следующие действия.   
* Для дальнейшего закрепления пользователь  Support манипулирует с планировщиком задач - Task Scheduler, в результате чего запускается вредоносный скрипт Update.bat, ограничиваются возможности сканера Windows Defender. В ходе этого позволяет исследуются архитектура сети, порты TCP/UDP, сервисы на них, собирается информация через сетевые протокола.  
* В целях организации утечки информации использовался ресурс www<span></span>.sendspase.com.  
  
## 2. Описание инцидента по матрице MITRE ATT&CK.  
Описание каждого из этапов инцидента по матрице MITRE ATT&CK нужно оформить в формате:
* указать технику;
* дать описание действиям атакующих и выполненным процедурам;
* подкрепить выводы скриншотами.  
### 2.1. Первоначальное проникновение (Initial Access)
Злоумышленники с помощью фишинговой рассылки получили доступ к сетевой инфраструктуре, отправив архив Refund_form.zip. Пользователь разархивировал файл и запустил. После этого был выполнен powershell скрипт закодированный по стандарту base64.  
### 2.2. Исполнение (Execution)  
С помощью вредоносной программы злоумышленники могли осуществлять сбор информации о системе. Кроме установки дополнительных программ и обновлений было запущено скачивание по-видимому вредоносных программ с ресурса www<span></span>.sendspase.com.
Дальнейшее закрепление в системе осуществлялось путем манипуляций с планировщиков и в реестре операционной системы.  
### 2.3. Повышение привилегий (Privilege Escalation)
Атакующие совершают успешное удаленное подключение от имени локального пользователя Wilfred. Поскольку пользователь Wilfred является локальным администратором у атакующих появился соответствующий контроль над системой. 
### 2.4. Обход защиты (Defence Evasion)  
В ходе атаки был создан новый пользователь - Support с повышенными привилегиями, под которым выполнялись многие следующие действия.  
### 2.5. Закрепление (Persistence)  
Для дальнейшего закрепления пользователь  Support манипулирует с планировщиком задач - Task Scheduler, в результате чего запускается вредоносный скрипт Update.bat, ограничиваются возможности сканера Windows Defender. В ходе этого позволяет исследуются архитектура сети, порты TCP/UDP, сервисы на них, собирается информация через сетевые протокола.
### 2.6. Утечка данных (Exfiltration)
Для организации утечки информации использовался ресурс www<span></span>.sendspase.com.  
### 2.7. Маппинг действий атакующих по матрице MITRE ATT&CK
Для наглядности инцидент далее представлен *маппинг действий атакующих по матрице MITRE ATT&CK* — в виде таблицы, отражающей соответствие тактики и техник, которые использовали атакующие в рамках исследуемого инцидента.
| Этап атаки  | ID техники |  Техника  | Комментарии |
|-----------|---------|----------|-----------|
| Initial Access (Первоначальный доступ) |	T1566.001 | Phishing:Spearphishing Attachment | Фишинговое письмо с архивом Refund_form.zip, содержащим вредоносный файл |
|Execution (Выполнение)|T1204.002| User Execution: Malicious File	| Обнаружен файл Refund_form.lnk, архив замаскированный под файл типа WordPad, содержащий вредоносный скрипт |
|Persistence (Закрепление)|T1053.005|	Scheduled Task/Job: Scheduled Task|Создание задач с регулярным выполнением|
|Persistence (Закрепление)|T1136|Create Account|Создание пользователя Support|
|Privilege Escalation (Повышение привилегий)|T1078.003|Valid Accounts: Local Accounts| Получение доступа к аккаунту легитимного пользователя Wilfred|
|Privilege Escalation (Повышение привилегий)|T1055|Process Injection|Инъекции в различные процессы|
|Defense Evasion (Предотвращение обнаружения)|T1078.003|Valid Accounts: Local Accounts|Создание пользователя Support|
|Defense Evasion (Предотвращение обнаружения)|T1211|Exploitation for Defense Evasion|Обновление версии Windows Defender|
|Defense Evasion (Предотвращение обнаружения)|T1070|Indicator Removal|Удаление файлов и манипуляции с временными метками|
|Credential Access (Получение учетных данных)|T1555.003|Credentials from Password Stores: Credentials from Web Browsers|Атакующие испольщовали файл с паролями пользователя passwords.txt, использование утилиты Iepv|
|Discovery (Исследование)|T1046|Network Service Discovery|Использование Netscan|
|Discovery (Исследование)|T1135|Network Share Discovery|Использование Netscan|
|Command and Control (Управление и Контроль)|T1219|Remote Access Software|Использование утилиты RDP Wrapper|
|Exfiltration (Эксфильтрация данных)|T1567.002|Exfiltration Over Web Service: Exfiltration to Cloud Storage|Использование ресурса <span></span>Sendspace.com|

## 3. Рекомендации по ликвидации последствий инцидента и восстановлению.   
Для ликвидации последствий инцидента, восстановления системы и предотвращения подобных атак в будущем рекомендуется:
1. удалить пользователя “Support”, созданного атакующими;
2. изменить аутентификационные данные скомпрометированного пользователя Wilfred;
3. исследовать на предмет закрепления, кодовых инъекций, настроек пользователя другие элементы сетевой инфраструктуру;
4. очистить от вредоносных файлов папки Temp, задач планировщика, особенно обращая на ярлыки файлов, архиво и .bat-файлам;
5. отредактировать реестры;
6. провести обучение персонала компании "X" на предмет фишинговых атак и безопасной работы с почтовыми ресурсами.
